import numpy

def exact_susceptibility(T, h : float = 0.02, J : int = 1, N : int = 50):
    beta = 1 / T
    tmp = (-N*(-1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) + beta*numpy.exp(J*beta)*numpy.sinh(beta*h))*(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N/(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h)) - N*(1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) + beta*numpy.exp(J*beta)*numpy.sinh(beta*h))*((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N/((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h)))*(N*(-1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) + beta*numpy.exp(J*beta)*numpy.sinh(beta*h))*(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N/(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h)) + N*(1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) + beta*numpy.exp(J*beta)*numpy.sinh(beta*h))*((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N/((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h)))/(beta*((-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N + ((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N)**2) + (N**2*(-1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) + beta*numpy.exp(J*beta)*numpy.sinh(beta*h))**2*(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N/(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**2 + N**2*(1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) + beta*numpy.exp(J*beta)*numpy.sinh(beta*h))**2*((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N/((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**2 + N*(-1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) - beta*numpy.exp(J*beta)*numpy.sinh(beta*h))*(1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) + beta*numpy.exp(J*beta)*numpy.sinh(beta*h))*((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N/((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**2 + N*(-1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) + beta*numpy.exp(J*beta)*numpy.sinh(beta*h))*(1.0*beta*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)*numpy.cosh(beta*h) - beta*numpy.exp(J*beta)*numpy.sinh(beta*h))*(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N/(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**2 + N*((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N*(-1.0*beta**2*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-1.5)*numpy.exp(4*J*beta)*numpy.sinh(beta*h)**2*numpy.cosh(beta*h)**2 + 1.0*beta**2*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)**2 + 1.0*beta**2*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 + beta**2*numpy.exp(J*beta)*numpy.cosh(beta*h))/((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h)) + N*(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N*(1.0*beta**2*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-1.5)*numpy.exp(4*J*beta)*numpy.sinh(beta*h)**2*numpy.cosh(beta*h)**2 - 1.0*beta**2*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.sinh(beta*h)**2 - 1.0*beta**2*(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**(-0.5)*numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 + beta**2*numpy.exp(J*beta)*numpy.cosh(beta*h))/(-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h)))/(beta*((-(numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N + ((numpy.exp(2*J*beta)*numpy.cosh(beta*h)**2 - 2*numpy.sinh(2*J*beta))**0.5 + numpy.exp(J*beta)*numpy.cosh(beta*h))**N))
    return tmp
